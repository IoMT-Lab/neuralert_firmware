<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DA16200 SDK: cc_util_rpmb.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DA16200 SDK
   &#160;<span id="projectnumber">3.1.0</span>
   </div>
   <div id="projectbrief">Ultra-low power Wi-Fi SoC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_ddeab0661943ca2a344224c1b2445b85.html">system</a></li><li class="navelem"><a class="el" href="dir_f174d6fae4e7f56ff8cc49434bec835f.html">include</a></li><li class="navelem"><a class="el" href="dir_19856d13d7eeacf102662a81299c9c23.html">crypto</a></li><li class="navelem"><a class="el" href="dir_c2b272b3daff5b986c2c0fc845762f68.html">shared</a></li><li class="navelem"><a class="el" href="dir_b2017a40e8b691f5fc8af1498b23ae3e.html">include</a></li><li class="navelem"><a class="el" href="dir_a9ad224adc02e998b1dd8f6fddbc5300.html">cc_util</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cc_util_rpmb.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the functions and definitions for the RPMB.  
<a href="#details">More...</a></p>

<p><a href="cc__util__rpmb_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acac48e7ab664316f3fa08f623f414ecb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cc__util__rpmb_8h.html#acac48e7ab664316f3fa08f623f414ecb">CC_UtilDeriveRPMBKey</a> (CCUtilRpmbKey_t pRpmbKey)</td></tr>
<tr class="memdesc:acac48e7ab664316f3fa08f623f414ecb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using KDR. Because the derivation is performed based on fixed data, the key does not need to be saved, and can be derived again consistently.  <a href="cc__util__rpmb_8h.html#acac48e7ab664316f3fa08f623f414ecb">More...</a><br /></td></tr>
<tr class="separator:acac48e7ab664316f3fa08f623f414ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac185aa5c6dfd174d95a5b9dc80a8c52c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cc__util__rpmb_8h.html#ac185aa5c6dfd174d95a5b9dc80a8c52c">CC_UtilSignRPMBFrames</a> (unsigned long *pListOfDataFrames, size_t listSize, CCUtilHmacResult_t pHmacResult)</td></tr>
<tr class="memdesc:ac185aa5c6dfd174d95a5b9dc80a8c52c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes HMAC SHA-256 authentication code of a sequence of 284 Byte RPMB frames (as defined in [JESD84]), using the RPMB key (which is derived internally using <a class="el" href="cc__util__rpmb_8h.html#acac48e7ab664316f3fa08f623f414ecb" title="This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using KDR....">CC_UtilDeriveRPMBKey</a>).  <a href="cc__util__rpmb_8h.html#ac185aa5c6dfd174d95a5b9dc80a8c52c">More...</a><br /></td></tr>
<tr class="separator:ac185aa5c6dfd174d95a5b9dc80a8c52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the functions and definitions for the RPMB. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="acac48e7ab664316f3fa08f623f414ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac48e7ab664316f3fa08f623f414ecb">&#9670;&nbsp;</a></span>CC_UtilDeriveRPMBKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilDeriveRPMBKey </td>
          <td>(</td>
          <td class="paramtype">CCUtilRpmbKey_t&#160;</td>
          <td class="paramname"><em>pRpmbKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using KDR. Because the derivation is performed based on fixed data, the key does not need to be saved, and can be derived again consistently. </p>
<dl class="section return"><dt>Returns</dt><dd>CC_UTIL_OK on success. </dd>
<dd>
A non-zero value on failure as defined in cc_util_error.h. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pRpmbKey</td><td>Pointer to 32byte output, to be used as RPMB key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac185aa5c6dfd174d95a5b9dc80a8c52c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac185aa5c6dfd174d95a5b9dc80a8c52c">&#9670;&nbsp;</a></span>CC_UtilSignRPMBFrames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilSignRPMBFrames </td>
          <td>(</td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>pListOfDataFrames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>listSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CCUtilHmacResult_t&#160;</td>
          <td class="paramname"><em>pHmacResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes HMAC SHA-256 authentication code of a sequence of 284 Byte RPMB frames (as defined in [JESD84]), using the RPMB key (which is derived internally using <a class="el" href="cc__util__rpmb_8h.html#acac48e7ab664316f3fa08f623f414ecb" title="This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using KDR....">CC_UtilDeriveRPMBKey</a>). </p>
<dl class="section return"><dt>Returns</dt><dd>CC_UTIL_OK on success. </dd>
<dd>
A non-zero value on failure as defined in cc_util_error.h. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pListOfDataFrames</td><td>Pointer to a list of 284 Byte frame addresses. The entire frame list is signed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">listSize</td><td>The number of 284 Byte frames in the list, up to 65,535. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pHmacResult</td><td>Pointer to the output data (HMAC result). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
