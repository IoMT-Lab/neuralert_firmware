<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DA16200 SDK: C:/00_WORK/SOURCE/SVN/DA16200_SDK_3/DA16200_FreeRTOS_DPM/core/system/src/crypto/cryptocell/codesafe/secure_boot_debug/cc3x_verifier/bootimagesverifier_api.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DA16200 SDK
   &#160;<span id="projectnumber">3.1.0</span>
   </div>
   <div id="projectbrief">Ultra-low power Wi-Fi SoC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_ddeab0661943ca2a344224c1b2445b85.html">system</a></li><li class="navelem"><a class="el" href="dir_553ec5c5672debf41120306329dcd2ba.html">src</a></li><li class="navelem"><a class="el" href="dir_c781a07f5c1970d3ce912a88a784ab8b.html">crypto</a></li><li class="navelem"><a class="el" href="dir_adfda410659efcf3e4152a2d38b3a85c.html">cryptocell</a></li><li class="navelem"><a class="el" href="dir_5c72872e194a0d05130c4a42c5f9ebeb.html">codesafe</a></li><li class="navelem"><a class="el" href="dir_5a79262c5a46b188fa5195c8dec3755e.html">secure_boot_debug</a></li><li class="navelem"><a class="el" href="dir_a14e7ad665189ed8bca135dae2ec1131.html">cc3x_verifier</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bootimagesverifier_api.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the set of Secure Boot APIs.  
<a href="#details">More...</a></p>

<p><a href="bootimagesverifier__api_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aeae6082f7288f0c14df7e2de07915ffc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="no__os_2cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootimagesverifier__api_8h.html#aeae6082f7288f0c14df7e2de07915ffc">CC_SbCertChainVerificationInit</a> (<a class="el" href="struct_c_c_sb_cert_info__t.html">CCSbCertInfo_t</a> *certPkgInfo)</td></tr>
<tr class="memdesc:aeae6082f7288f0c14df7e2de07915ffc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes the Secure Boot certificate chain processing, and must be the first API called when processing Secure Boot certificate chain. It initializes the internal data fields of the certificate package.  <a href="bootimagesverifier__api_8h.html#aeae6082f7288f0c14df7e2de07915ffc">More...</a><br /></td></tr>
<tr class="separator:aeae6082f7288f0c14df7e2de07915ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320a6d65347ad8a6c224a2a8402aa246"><td class="memItemLeft" align="right" valign="top"><a class="el" href="no__os_2cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bootimagesverifier__api_8h.html#a320a6d65347ad8a6c224a2a8402aa246">CC_SbCertVerifySingle</a> (<a class="el" href="group__cc__sb__gen__defs.html#gae7a26d40edf1d354182140692154fba3">CCSbFlashReadFunc</a> flashReadFunc, void *userContext, unsigned long hwBaseAddress, <a class="el" href="group__cc__pal__sb__plat.html#ga757efd625496717c850d43ec97e1f716">CCAddr_t</a> certStoreAddress, <a class="el" href="struct_c_c_sb_cert_info__t.html">CCSbCertInfo_t</a> *certPkgInfo, uint32_t *pHeader, uint32_t headerSize, uint32_t *pWorkspace, uint32_t workspaceSize)</td></tr>
<tr class="memdesc:a320a6d65347ad8a6c224a2a8402aa246"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function verifies a single certificate package (containing either a key or content certificate). It verifies the following:  <a href="bootimagesverifier__api_8h.html#a320a6d65347ad8a6c224a2a8402aa246">More...</a><br /></td></tr>
<tr class="separator:a320a6d65347ad8a6c224a2a8402aa246"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the set of Secure Boot APIs. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aeae6082f7288f0c14df7e2de07915ffc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae6082f7288f0c14df7e2de07915ffc">&#9670;&nbsp;</a></span>CC_SbCertChainVerificationInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="no__os_2cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_SbCertChainVerificationInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sb_cert_info__t.html">CCSbCertInfo_t</a> *&#160;</td>
          <td class="paramname"><em>certPkgInfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes the Secure Boot certificate chain processing, and must be the first API called when processing Secure Boot certificate chain. It initializes the internal data fields of the certificate package. </p>
<dl class="section return"><dt>Returns</dt><dd>CC_OK on success. </dd>
<dd>
A non-zero value from sbrom_bsv_error.h on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">certPkgInfo</td><td>Pointer to the information about the certificate package </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a320a6d65347ad8a6c224a2a8402aa246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a320a6d65347ad8a6c224a2a8402aa246">&#9670;&nbsp;</a></span>CC_SbCertVerifySingle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="no__os_2cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_SbCertVerifySingle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cc__sb__gen__defs.html#gae7a26d40edf1d354182140692154fba3">CCSbFlashReadFunc</a>&#160;</td>
          <td class="paramname"><em>flashReadFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>hwBaseAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__pal__sb__plat.html#ga757efd625496717c850d43ec97e1f716">CCAddr_t</a>&#160;</td>
          <td class="paramname"><em>certStoreAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_sb_cert_info__t.html">CCSbCertInfo_t</a> *&#160;</td>
          <td class="paramname"><em>certPkgInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pHeader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>headerSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pWorkspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>workspaceSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function verifies a single certificate package (containing either a key or content certificate). It verifies the following: </p>
<ul>
<li>
The public key (as saved in the certificate) against its Hash that is either found in the OTP memory (HBK) or in certPkgInfo. </li>
<li>
The certificate's RSA signature. </li>
<li>
The SW version in the certificate must be higher than or equal to the minimum SW version, as recorded on the device and passed in certPkgInfo. </li>
<li>
Each SW module against its Hash in the certificate (for content certificates).</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>CC_OK On success. </dd>
<dd>
A non-zero value from <a class="el" href="bsv__error_8h.html" title="This file defines the error code types returned from the Boot Services API&#39;s.">bsv_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flashReadFunc</td><td>Pointer to the flash read function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">userContext</td><td>An additional pointer for flashRead usage. May be NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hwBaseAddress</td><td>CryptoCell HW registers' base address. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">certStoreAddress</td><td>Flash address where the certificate is located. This address is provided to flashReadFunc. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">certPkgInfo</td><td>Pointer to the information about the certificate package. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pHeader</td><td>Pointer to a buffer used for extracting the X509 TBS Headers. Must be NULL for proprietary certificates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">headerSize</td><td>The size of pHeader in bytes. Must be 0 for proprietary certificates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pWorkspace</td><td>Buffer for the function's internal use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">workspaceSize</td><td>The size of the workspace in bytes. Must be at least CC_SB_MIN_WORKSPACE_SIZE_IN_BYTES. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
