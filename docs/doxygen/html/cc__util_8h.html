<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DA16200 SDK: cc_util.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DA16200 SDK
   &#160;<span id="projectnumber">3.1.0</span>
   </div>
   <div id="projectbrief">Ultra-low power Wi-Fi SoC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_ddeab0661943ca2a344224c1b2445b85.html">system</a></li><li class="navelem"><a class="el" href="dir_f174d6fae4e7f56ff8cc49434bec835f.html">include</a></li><li class="navelem"><a class="el" href="dir_19856d13d7eeacf102662a81299c9c23.html">crypto</a></li><li class="navelem"><a class="el" href="dir_c2b272b3daff5b986c2c0fc845762f68.html">shared</a></li><li class="navelem"><a class="el" href="dir_b2017a40e8b691f5fc8af1498b23ae3e.html">include</a></li><li class="navelem"><a class="el" href="dir_a9ad224adc02e998b1dd8f6fddbc5300.html">cc_util</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cc_util.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains CryptoCell Util functions and definitions.  
<a href="#details">More...</a></p>

<p><a href="cc__util_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac98fd85432288b350568b6acac198a45"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="struct_c_c_ecpki_kg_fips_context__t.html">CCEcpkiKgFipsContext_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cc__util_8h.html#ac98fd85432288b350568b6acac198a45">CCUtilEkFipsContext_t</a></td></tr>
<tr class="separator:ac98fd85432288b350568b6acac198a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e342722b5c2ac8c71e5c5a1aea35c5"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cc__util_8h.html#a92e342722b5c2ac8c71e5c5a1aea35c5">CCUtilEkTempData_t</a></td></tr>
<tr class="separator:a92e342722b5c2ac8c71e5c5a1aea35c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ada4bf53bd0ba843e1f6068e75f6b88b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cc__util_8h.html#ada4bf53bd0ba843e1f6068e75f6b88b7">CC_UtilDeriveEndorsementKey</a> (CCUtilEkDomainID_t domainID, CCUtilEkPrivkey_t *pPrivKey_ptr, CCUtilEkPubkey_t *pPublKey_ptr, <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a> *pTempDataBuf, <a class="el" href="struct_c_c_rnd_context__t.html">CCRndContext_t</a> *pRndContext, <a class="el" href="cc__util_8h.html#ac98fd85432288b350568b6acac198a45">CCUtilEkFipsContext_t</a> *pEkFipsCtx)</td></tr>
<tr class="memdesc:ada4bf53bd0ba843e1f6068e75f6b88b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the device unique endorsement key, as an ECC256 key pair, derived from the device root key (KDR). Prior to using this ECC key pair with CC ECC APIs, translate the domain ID that was used to create it, to a CryptoCell domain ID:  <a href="cc__util_8h.html#ada4bf53bd0ba843e1f6068e75f6b88b7">More...</a><br /></td></tr>
<tr class="separator:ada4bf53bd0ba843e1f6068e75f6b88b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49c59c14dd9c9ee390e425ef834d1fd4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cc__util_8h.html#a49c59c14dd9c9ee390e425ef834d1fd4">CC_UtilSetSessionKey</a> (<a class="el" href="struct_c_c_rnd_context__t.html">CCRndContext_t</a> *pRndContext)</td></tr>
<tr class="memdesc:a49c59c14dd9c9ee390e425ef834d1fd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds a random session key (KSESS), and sets it to the session key registers. It must be used as early as possible during the boot sequence, but only after the RNG is initialized.  <a href="cc__util_8h.html#a49c59c14dd9c9ee390e425ef834d1fd4">More...</a><br /></td></tr>
<tr class="separator:a49c59c14dd9c9ee390e425ef834d1fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af28eb0f7223edb0e8c5096bde50588bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cc__util_8h.html#af28eb0f7223edb0e8c5096bde50588bd">CC_UtilSetSecurityDisable</a> (void)</td></tr>
<tr class="memdesc:af28eb0f7223edb0e8c5096bde50588bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function disables the device security. The function does the following:  <a href="cc__util_8h.html#af28eb0f7223edb0e8c5096bde50588bd">More...</a><br /></td></tr>
<tr class="separator:af28eb0f7223edb0e8c5096bde50588bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains CryptoCell Util functions and definitions. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="ac98fd85432288b350568b6acac198a45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac98fd85432288b350568b6acac198a45">&#9670;&nbsp;</a></span>CCUtilEkFipsContext_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="struct_c_c_ecpki_kg_fips_context__t.html">CCEcpkiKgFipsContext_t</a> <a class="el" href="cc__util_8h.html#ac98fd85432288b350568b6acac198a45">CCUtilEkFipsContext_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Required for internal FIPS verification for Endorsement key derivation. </p>

</div>
</div>
<a id="a92e342722b5c2ac8c71e5c5a1aea35c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e342722b5c2ac8c71e5c5a1aea35c5">&#9670;&nbsp;</a></span>CCUtilEkTempData_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a>  <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Required for Endorsement key derivation. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ada4bf53bd0ba843e1f6068e75f6b88b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada4bf53bd0ba843e1f6068e75f6b88b7">&#9670;&nbsp;</a></span>CC_UtilDeriveEndorsementKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilDeriveEndorsementKey </td>
          <td>(</td>
          <td class="paramtype">CCUtilEkDomainID_t&#160;</td>
          <td class="paramname"><em>domainID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CCUtilEkPrivkey_t *&#160;</td>
          <td class="paramname"><em>pPrivKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CCUtilEkPubkey_t *&#160;</td>
          <td class="paramname"><em>pPublKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a> *&#160;</td>
          <td class="paramname"><em>pTempDataBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_rnd_context__t.html">CCRndContext_t</a> *&#160;</td>
          <td class="paramname"><em>pRndContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cc__util_8h.html#ac98fd85432288b350568b6acac198a45">CCUtilEkFipsContext_t</a> *&#160;</td>
          <td class="paramname"><em>pEkFipsCtx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the device unique endorsement key, as an ECC256 key pair, derived from the device root key (KDR). Prior to using this ECC key pair with CC ECC APIs, translate the domain ID that was used to create it, to a CryptoCell domain ID: </p>
<ul>
<li>
CC_UTIL_EK_DomainID_secp256r1 - CC_ECPKI_DomainID_secp256r1. </li>
<li>
CC_UTIL_EK_DomainID_secp256k1 - CC_ECPKI_DomainID_secp256k1.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>CC_UTIL_OK on success. </dd>
<dd>
A non-zero value on failure as defined cc_util_error.h. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">domainID</td><td>Selection of domain ID for the key. The following domain IDs are supported: <ul>
<li>
CC_UTIL_EK_DomainID_secp256r1 (compliant with [TBBR_C].) </li>
<li>
CC_UTIL_EK_DomainID_secp256k1. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPrivKey_ptr</td><td>Pointer to the derived private key. To use this private key with CC ECC, use <a class="el" href="group__cryptocell__ecpki.html#ga64da5c0ad2a43995b70be3530dbaec10" title="Builds (imports) the user private key structure from an existing private key so that this structure c...">CC_EcpkiPrivKeyBuild</a> (CC domainID, pPrivKey_ptr, sizeof(*pPrivKey_ptr), UserPrivKey_ptr) to convert to CC ECC private key format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPublKey_ptr</td><td>Pointer to the derived public key, in [X||Y] format (X and Y being the point coordinates). To use this public key with CC ECC: <ul>
<li>
Concatenate a single byte with value 0x04 (indicating uncompressed format) with pPublKey_ptr in the following order [0x04||X||Y]. </li>
<li>
Call <a class="el" href="group__cryptocell__ecpki.html#ga6c49c7b8c24ceff4c7e0492d5876cf85" title="This macro calls CC_EcpkiPublKeyBuildAndCheck function for building the public key while checking inp...">CC_EcpkiPubKeyBuild</a> (CC domainID, [PC || pPublKey_ptr], 1+sizeof(*pPublKey_ptr), UserPublKey_ptr) to convert to CC_ECC public key format.</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pTempDataBuf</td><td>Temporary buffers for internal use. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pRndContext</td><td>Pointer to the RND context buffer used in case FIPS certification if required (may be NULL for all other cases). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pEkFipsCtx</td><td>Pointer to temporary buffer used in case FIPS certification if required (may be NULL for all other cases). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af28eb0f7223edb0e8c5096bde50588bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af28eb0f7223edb0e8c5096bde50588bd">&#9670;&nbsp;</a></span>CC_UtilSetSecurityDisable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilSetSecurityDisable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function disables the device security. The function does the following: </p>
<ol>
<li>
Sets the security disabled register. </li>
<li>
Sets the session key register to 0.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>If ARM SDER register is to be set the user must set the device to temporary Security Disabled by calling this API prior to setting the register.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>CC_UTIL_OK on success. </dd>
<dd>
A non-zero value on failure as defined cc_util_error.h. </dd></dl>

</div>
</div>
<a id="a49c59c14dd9c9ee390e425ef834d1fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49c59c14dd9c9ee390e425ef834d1fd4">&#9670;&nbsp;</a></span>CC_UtilSetSessionKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__defs.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilSetSessionKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_rnd_context__t.html">CCRndContext_t</a> *&#160;</td>
          <td class="paramname"><em>pRndContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds a random session key (KSESS), and sets it to the session key registers. It must be used as early as possible during the boot sequence, but only after the RNG is initialized. </p>
<dl class="section note"><dt>Note</dt><dd>If this API is called more than once, each subsequent call invalidates any prior session-key-based authentication. These prior authentications have to be authenticated again. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Whenever the device reconfigures memory buffers previously used for secure content, to become accessible from non-secure context, <a class="el" href="cc__util_8h.html#a49c59c14dd9c9ee390e425ef834d1fd4" title="This function builds a random session key (KSESS), and sets it to the session key registers....">CC_UtilSetSessionKey</a> must be invoked to set a new session key, and thus invalidate any existing secure key packages.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>CC_UTIL_OK on success. </dd>
<dd>
A non-zero value on failure as defined cc_util_error.h. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pRndContext</td><td>Pointer to the RND context buffer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
