/**
 ****************************************************************************************
 *
 * @file ieee80211_radiotap.h
 *
 * @brief Header file
 *
 * Copyright (c) 2016-2022 Renesas Electronics. All rights reserved.
 *
 * This software ("Software") is owned by Renesas Electronics.
 *
 * By using this Software you agree that Renesas Electronics retains all
 * intellectual property and proprietary rights in and to this Software and any
 * use, reproduction, disclosure or distribution of the Software without express
 * written permission or a license agreement from Renesas Electronics is
 * strictly prohibited. This Software is solely for use on or in conjunction
 * with Renesas Electronics products.
 *
 * EXCEPT AS OTHERWISE PROVIDED IN A LICENSE AGREEMENT BETWEEN THE PARTIES, THE
 * SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. EXCEPT AS OTHERWISE
 * PROVIDED IN A LICENSE AGREEMENT BETWEEN THE PARTIES, IN NO EVENT SHALL
 * RENESAS ELECTRONICS BE LIABLE FOR ANY DIRECT, SPECIAL, INDIRECT, INCIDENTAL,
 * OR CONSEQUENTIAL DAMAGES, OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF
 * USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
 * TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE
 * OF THE SOFTWARE.
 *
 ****************************************************************************************
 */

#ifndef IEEE80211RADIOTAP_H
#define IEEE80211RADIOTAP_H

#include "le_byteshift.h"

#define PKTHDR_RADIOTAP_VERSION		0

struct i3ed11_radiotap_header
{
	u8 it_version;
	u8 it_pad;
	__le16 it_len;
	__le32 it_present;
} __packed;

enum i3ed11_radiotap_type
{
	I3ED11_RADIOTAP_TSFT = 0,
	I3ED11_RADIOTAP_FLAGS = 1,
	I3ED11_RADIOTAP_RATE = 2,
	I3ED11_RADIOTAP_CHANNEL = 3,
	I3ED11_RADIOTAP_FHSS = 4,
	I3ED11_RADIOTAP_DBM_ANTSIGNAL = 5,
	I3ED11_RADIOTAP_DBM_ANTNOISE = 6,
	I3ED11_RADIOTAP_LOCK_QUALITY = 7,
	I3ED11_RADIOTAP_TX_ATTENUATION = 8,
	I3ED11_RADIOTAP_DB_TX_ATTENUATION = 9,
	I3ED11_RADIOTAP_DBM_TX_POWER = 10,
	I3ED11_RADIOTAP_ANTENNA = 11,
	I3ED11_RADIOTAP_DB_ANTSIGNAL = 12,
	I3ED11_RADIOTAP_DB_ANTNOISE = 13,
	I3ED11_RADIOTAP_RX_FLAGS = 14,
	I3ED11_RADIOTAP_TX_FLAGS = 15,
	I3ED11_RADIOTAP_RTS_RETRIES = 16,
	I3ED11_RADIOTAP_DATA_RETRIES = 17,

	I3ED11_RADIOTAP_MCS = 19,
	I3ED11_RADIOTAP_AMPDU_STATUS = 20,
	I3ED11_RADIOTAP_VHT = 21,

	I3ED11_RADIOTAP_RADIOTAP_NAMESPACE = 29,
	I3ED11_RADIOTAP_VENDOR_NAMESPACE = 30,
	I3ED11_RADIOTAP_EXT = 31
};

/* Channel flags. */
#define	I3ED11_CHAN_TURBO	0x0010
#define	I3ED11_CHAN_CCK		0x0020
#define	I3ED11_CHAN_OFDM	0x0040
#define	I3ED11_CHAN_2GHZ	0x0080
#define	I3ED11_CHAN_5GHZ	0x0100
#define	I3ED11_CHAN_PASSIVE	0x0200
#define	I3ED11_CHAN_DYN		0x0400
#define	I3ED11_CHAN_GFSK	0x0800
#define	I3ED11_CHAN_GSM		0x1000
#define	I3ED11_CHAN_STURBO	0x2000
#define	I3ED11_CHAN_HALF	0x4000
#define	I3ED11_CHAN_QUARTER	0x8000

/* For I3ED11_RADIOTAP_FLAGS */
#define	I3ED11_RADIOTAP_F_CFP	0x01
#define	I3ED11_RADIOTAP_F_SHORTPRE	0x02
#define	I3ED11_RADIOTAP_F_WEP	0x04
#define	I3ED11_RADIOTAP_F_FRAG	0x08
#define	I3ED11_RADIOTAP_F_FCS	0x10
#define	I3ED11_RADIOTAP_F_DATAPAD	0x20
#define I3ED11_RADIOTAP_F_BADFCS	0x40

/* For I3ED11_RADIOTAP_RX_FLAGS */
#define I3ED11_RADIOTAP_F_RX_BADPLCP	0x0002

/* For I3ED11_RADIOTAP_TX_FLAGS */
#define I3ED11_RADIOTAP_F_TX_FAIL	0x0001
#define I3ED11_RADIOTAP_F_TX_CTS	0x0002
#define I3ED11_RADIOTAP_F_TX_RTS	0x0004
#define I3ED11_RADIOTAP_F_TX_NOACK	0x0008

/* For I3ED11_RADIOTAP_MCS */
#define I3ED11_RADIOTAP_MCS_HAVE_BW		0x01
#define I3ED11_RADIOTAP_MCS_HAVE_MCS	0x02
#define I3ED11_RADIOTAP_MCS_HAVE_GI		0x04
#define I3ED11_RADIOTAP_MCS_HAVE_FMT	0x08
#define I3ED11_RADIOTAP_MCS_HAVE_FEC	0x10
#define I3ED11_RADIOTAP_MCS_HAVE_STBC	0x20

#define I3ED11_RADIOTAP_MCS_BW_MASK		0x03
#define I3ED11_RADIOTAP_MCS_BW_20	0
#define I3ED11_RADIOTAP_MCS_BW_40	1
#define I3ED11_RADIOTAP_MCS_BW_20L	2
#define I3ED11_RADIOTAP_MCS_BW_20U	3
#define I3ED11_RADIOTAP_MCS_SGI		0x04
#define I3ED11_RADIOTAP_MCS_FMT_GF		0x08
#define I3ED11_RADIOTAP_MCS_FEC_LDPC	0x10
#define I3ED11_RADIOTAP_MCS_STBC_MASK	0x60
#define I3ED11_RADIOTAP_MCS_STBC_1	1
#define I3ED11_RADIOTAP_MCS_STBC_2	2
#define I3ED11_RADIOTAP_MCS_STBC_3	3

#define I3ED11_RADIOTAP_MCS_STBC_SHIFT	5

/* For I3ED11_RADIOTAP_AMPDU_STATUS */
#define I3ED11_RADIOTAP_AMPDU_REPORT_ZEROLEN		0x0001
#define I3ED11_RADIOTAP_AMPDU_IS_ZEROLEN		0x0002
#define I3ED11_RADIOTAP_AMPDU_LAST_KNOWN		0x0004
#define I3ED11_RADIOTAP_AMPDU_IS_LAST		0x0008
#define I3ED11_RADIOTAP_AMPDU_DELIM_CRC_ERR		0x0010
#define I3ED11_RADIOTAP_AMPDU_DELIM_CRC_KNOWN	0x0020

/* For I3ED11_RADIOTAP_VHT */
#define I3ED11_RADIOTAP_VHT_KNOWN_STBC			0x0001
#define I3ED11_RADIOTAP_VHT_KNOWN_TXOP_PS_NA			0x0002
#define I3ED11_RADIOTAP_VHT_KNOWN_GI				0x0004
#define I3ED11_RADIOTAP_VHT_KNOWN_SGI_NSYM_DIS		0x0008
#define I3ED11_RADIOTAP_VHT_KNOWN_LDPC_EXTRA_OFDM_SYM	0x0010
#define I3ED11_RADIOTAP_VHT_KNOWN_BEAMFORMED			0x0020
#define I3ED11_RADIOTAP_VHT_KNOWN_BANDWIDTH			0x0040
#define I3ED11_RADIOTAP_VHT_KNOWN_GROUP_ID			0x0080
#define I3ED11_RADIOTAP_VHT_KNOWN_PARTIAL_AID		0x0100

#define I3ED11_RADIOTAP_VHT_FLAG_STBC			0x01
#define I3ED11_RADIOTAP_VHT_FLAG_TXOP_PS_NA			0x02
#define I3ED11_RADIOTAP_VHT_FLAG_SGI				0x04
#define I3ED11_RADIOTAP_VHT_FLAG_SGI_NSYM_M10_9		0x08
#define I3ED11_RADIOTAP_VHT_FLAG_LDPC_EXTRA_OFDM_SYM		0x10
#define I3ED11_RADIOTAP_VHT_FLAG_BEAMFORMED			0x20

#endif				/* I3ED11_RADIOTAP_H */
